{% extends 'base.html' %}

{% block title %}Заказ №{{ order.id }}{% endblock %}

{% block content %}
<div>
    <div>
        <a href="{% url 'catalog:order_list' %}">
            &lt; Назад к списку заказов
        </a>
    </div>

    <h2>Заказ id{{ order.id }}</h2>

    <div>
        <h4>Информация о заказе</h4>
        <dl>
            <dt>Компания</dt>
            <dd>{{ order.client.company_name }}</dd>
            <dt>Продукция</dt>
            <dd>{{ order.product.name }}</dd>
            <dt>Количество</dt>
            <dd>{{ order.quantity }}</dd>
            <dt>Дата заказа</dt>
            <dd>{{ order.order_date }}</dd>
            <dt>Дата выполнения</dt>
            <dd>{{ order.completion_date|default:'—' }}</dd>
            <dt>Статус</dt>
            <dd>{{ order.get_status_display }}</dd>
            <dt>Сумма</dt>
            <dd>{{ order.total_amount }} руб.</dd>
        </dl>
    </div>

    {% if user.employee and order.status == 'paid' %}
    <div>
        <form method="post">
            {% csrf_token %}
            <button type="submit" name="mark_as_accepted">
                Принять к исполнению
            </button>
        </form>
    </div>
    {% endif %}

    {% if user.client and order.status == 'new' %}
    <div>
        <a href="{% url 'catalog:payment' order.id %}">
            <button type="button">
                Оплатить
            </button>
        </a>
    </div>

    <div>
        <form method="post">
            {% csrf_token %}
            <label for="quantity">Изменить количество:</label>
            <input type="number" id="quantity" name="quantity" value="{{ order.quantity }}" required>
            <button type="submit" name="change_quantity">
                Изменить
            </button>
        </form>
    </div>
    
    <div>
        <form method="post">
            {% csrf_token %}
            <button type="submit" name="delete_order" style="color: red;">
                Удалить заказ
            </button>
        </form>
    </div>
    {% endif %}
</div>
{% endblock %}